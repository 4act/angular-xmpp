
<div ng-show="connected"  class="buddycloud" >

<!--
<form ng-submit="create()">
<input ng-model="newnode" placeholder="What's going on" >
</form>
-->
<br/>

<div ng-if="node!='recent'">
<button ng-click="subscribe()">subscribe</button>
<button ng-click="unsubscribe()">unsubscribe</button>
<button ng-click="addFriend(node)" class="pull-right">add Friend</button>
<button ng-click="removeFriend(node)" class="pull-right">remove Friend</button>
<br/>
</div>
<br/>
<form ng-submit="publish()">
<textarea ng-model="newtopic" placeholder="What's going on" ></textarea>
<input ng-show="newtopic" type="submit"/>
</form>



<div  ng-repeat="item in tree |toArray|orderBy:'-entry.atom.published' " class="item">
    <span class="tool pull-right" ng-click="removeitem(item.entry.atom.id,item.node)">×</span>
    <span class="tool pull-right" ng-click="edititem(editmode=!editmode)">✎</span>
<img  ng-src="icons/avatars/{{item.entry.atom.author.image}}.png" />
<div class="person">
<span class="name">
<span ng-click="opennode(item.entry.atom.author.name)">{{item.entry.atom.author.name}}</span>
<span ng-click="opennode(item.nodeowner)" ng-show="item.entry.atom.author.name!=item.nodeowner && node=='recent'"> → {{item.nodeowner}}</span>
</span>
<span class="date">{{item.entry.atom.published | date:'medium'}}</span>

</div>
<div class="content">
<form ng-show="editmode" ng-submit="save()">
<textarea  ng-model="item.entry.atom.content.content"></textarea>
<input type="submit"/>
</form>
<div ng-show="!editmode" btf-markdown="item.entry.atom.content.content"></div>

</div>
<span class="like">like . share</span>
<br/>
<div ng-repeat="subitem in item.nodes|toArray|orderBy:'entry.atom.published'" class="subitem">

    <span class="tool pull-right" ng-click="removeitem(subitem.entry.atom.id,subitem.node)">×</span>
    <span class="tool pull-right" ng-click="edititem(editmode=!editmode)">✎</span>
    <img  ng-src="icons/avatars/{{subitem.entry.atom.author.image}}.png" />
    <div class="person">
    <span class="name" ng-click="opennode(subitem.entry.atom.author.name)">{{subitem.entry.atom.author.name}}</span>
    <input ng-show="editmode" ng-model="subitem.entry.atom.content.content" />
    <span ng-show="!editmode">{{subitem.entry.atom.content.content}}</span>

    <span class="date">{{subitem.entry.atom.published | date:'medium'}}</span>
    </div>
</div>
<form ng-submit="publish(item.entry.atom.id)" class="subitem">
<img  ng-src="icons/avatars/{{jid.local}}.png" />
    <div class="person">
<input ng-model="newitems[item.entry.atom.id]" />
</div>
</form>
</div>
</div>

